openapi: 3.0.3
info:
  title: Newsletter Service API
  description: A comprehensive newsletter management service with enterprise-grade features
  version: 1.0.0
  contact:
    name: Newsletter Service Support
    email: support@newsletter-service.com
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT

servers:
  - url: https://your-app.herokuapp.com
    description: Production server
  - url: http://localhost:8080
    description: Local development server

security:
  - BasicAuth: []
  - SchedulerAuth: []

paths:
  # Health Endpoints
  /health:
    get:
      summary: Main service health check
      description: Check if the main service is healthy and responsive
      tags:
        - Health
      security: []
      responses:
        '200':
          description: Service is healthy
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthResponse'

  /scheduler/v1/health:
    get:
      summary: Scheduler service health check
      description: Check if the scheduler service is healthy and responsive
      tags:
        - Health
        - Scheduler
      security:
        - SchedulerAuth: []
      responses:
        '200':
          description: Scheduler service is healthy
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SchedulerHealthResponse'
        '401':
          $ref: '#/components/responses/UnauthorizedError'

  # Topic Endpoints
  /api/v1/topics:
    get:
      summary: List all topics
      description: Retrieve a list of all newsletter topics with optional pagination
      tags:
        - Topics
      security:
        - BasicAuth: []
      parameters:
        - name: page
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            default: 1
          description: Page number for pagination (starts from 1)
        - name: page_size
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
          description: Number of items per page (max 100)
      responses:
        '200':
          description: List of topics
          content:
            application/json:
              schema:
                oneOf:
                  - type: array
                    items:
                      $ref: '#/components/schemas/TopicResponse'
                    description: Non-paginated response (when no pagination parameters provided)
                  - $ref: '#/components/schemas/PaginatedTopicsResponse'
                    description: Paginated response (when pagination parameters provided)
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '500':
          $ref: '#/components/responses/InternalServerError'

    post:
      summary: Create a new topic
      description: Create a new newsletter topic
      tags:
        - Topics
      security:
        - BasicAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateTopicRequest'
      responses:
        '201':
          description: Topic created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TopicResponse'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/v1/topics/{id}:
    parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int32
        description: Topic ID

    get:
      summary: Get topic by ID
      description: Retrieve a specific topic by its ID
      tags:
        - Topics
      security:
        - BasicAuth: []
      responses:
        '200':
          description: Topic details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TopicResponse'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
        '500':
          $ref: '#/components/responses/InternalServerError'

    put:
      summary: Update topic
      description: Update an existing topic
      tags:
        - Topics
      security:
        - BasicAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateTopicRequest'
      responses:
        '200':
          description: Topic updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessMessage'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
        '500':
          $ref: '#/components/responses/InternalServerError'

    delete:
      summary: Delete topic
      description: Delete a topic by its ID
      tags:
        - Topics
      security:
        - BasicAuth: []
      responses:
        '200':
          description: Topic deleted successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessMessage'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
        '500':
          $ref: '#/components/responses/InternalServerError'

  # Subscriber Endpoints
  /api/v1/subscribers:
    get:
      summary: List all subscribers
      description: Retrieve a list of all newsletter subscribers with optional pagination
      tags:
        - Subscribers
      security:
        - BasicAuth: []
      parameters:
        - name: page
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            default: 1
          description: Page number for pagination (starts from 1)
        - name: page_size
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
          description: Number of items per page (max 100)
      responses:
        '200':
          description: List of subscribers
          content:
            application/json:
              schema:
                oneOf:
                  - type: array
                    items:
                      $ref: '#/components/schemas/SubscriberResponse'
                    description: Non-paginated response (when no pagination parameters provided)
                  - $ref: '#/components/schemas/PaginatedSubscribersResponse'
                    description: Paginated response (when pagination parameters provided)
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '500':
          $ref: '#/components/responses/InternalServerError'

    post:
      summary: Create a new subscriber
      description: Create a new newsletter subscriber
      tags:
        - Subscribers
      security:
        - BasicAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateSubscriberRequest'
      responses:
        '201':
          description: Subscriber created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SubscriberResponse'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/v1/subscribers/{id}:
    parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int32
        description: Subscriber ID

    get:
      summary: Get subscriber by ID
      description: Retrieve a specific subscriber by their ID
      tags:
        - Subscribers
      security:
        - BasicAuth: []
      responses:
        '200':
          description: Subscriber details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SubscriberResponse'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
        '500':
          $ref: '#/components/responses/InternalServerError'

    put:
      summary: Update subscriber
      description: Update an existing subscriber
      tags:
        - Subscribers
      security:
        - BasicAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateSubscriberRequest'
      responses:
        '200':
          description: Subscriber updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessMessage'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
        '500':
          $ref: '#/components/responses/InternalServerError'

    delete:
      summary: Delete subscriber
      description: Delete a subscriber by their ID
      tags:
        - Subscribers
      security:
        - BasicAuth: []
      responses:
        '200':
          description: Subscriber deleted successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessMessage'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
        '500':
          $ref: '#/components/responses/InternalServerError'

  # Subscription Endpoints
  /api/v1/subscriptions:
    get:
      summary: List all subscriptions
      description: Retrieve a list of all subscriptions with optional pagination
      tags:
        - Subscriptions
      security:
        - BasicAuth: []
      parameters:
        - name: page
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            default: 1
          description: Page number for pagination (starts from 1)
        - name: page_size
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
          description: Number of items per page (max 100)
      responses:
        '200':
          description: List of subscriptions
          content:
            application/json:
              schema:
                oneOf:
                  - type: array
                    items:
                      $ref: '#/components/schemas/SubscriptionResponse'
                    description: Non-paginated response (when no pagination parameters provided)
                  - $ref: '#/components/schemas/PaginatedSubscriptionsResponse'
                    description: Paginated response (when pagination parameters provided)
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '500':
          $ref: '#/components/responses/InternalServerError'

    post:
      summary: Create a new subscription
      description: Subscribe a user to a topic
      tags:
        - Subscriptions
      security:
        - BasicAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateSubscriptionRequest'
      responses:
        '201':
          description: Subscription created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessMessage'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/v1/subscriptions/subscriber/{subscriber_id}:
    parameters:
      - name: subscriber_id
        in: path
        required: true
        schema:
          type: integer
          format: int32
        description: Subscriber ID

    get:
      summary: Get subscriptions by subscriber
      description: Retrieve all subscriptions for a specific subscriber
      tags:
        - Subscriptions
      security:
        - BasicAuth: []
      responses:
        '200':
          description: List of subscriber's subscriptions
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/SubscriptionResponse'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/v1/subscriptions/topic/{topic_id}:
    parameters:
      - name: topic_id
        in: path
        required: true
        schema:
          type: integer
          format: int32
        description: Topic ID

    get:
      summary: Get subscriptions by topic
      description: Retrieve all subscriptions for a specific topic
      tags:
        - Subscriptions
      security:
        - BasicAuth: []
      responses:
        '200':
          description: List of topic's subscriptions
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/SubscriptionResponse'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/v1/subscriptions/{id}:
    parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int32
        description: Subscription ID

    delete:
      summary: Delete subscription
      description: Unsubscribe a user from a topic
      tags:
        - Subscriptions
      security:
        - BasicAuth: []
      responses:
        '200':
          description: Subscription deleted successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessMessage'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
        '500':
          $ref: '#/components/responses/InternalServerError'

  # Content Endpoints
  /api/v1/contents:
    get:
      summary: List all content
      description: Retrieve a list of all newsletter content with optional pagination
      tags:
        - Content
      security:
        - BasicAuth: []
      parameters:
        - name: page
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            default: 1
          description: Page number for pagination (starts from 1)
        - name: page_size
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
          description: Number of items per page (max 100)
      responses:
        '200':
          description: List of content
          content:
            application/json:
              schema:
                oneOf:
                  - type: array
                    items:
                      $ref: '#/components/schemas/ContentResponse'
                    description: Non-paginated response (when no pagination parameters provided)
                  - $ref: '#/components/schemas/PaginatedContentResponse'
                    description: Paginated response (when pagination parameters provided)
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '500':
          $ref: '#/components/responses/InternalServerError'

    post:
      summary: Create new content
      description: Create new newsletter content
      tags:
        - Content
      security:
        - BasicAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateContentRequest'
      responses:
        '201':
          description: Content created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ContentResponse'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/v1/contents/{id}:
    parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int32
        description: Content ID

    get:
      summary: Get content by ID
      description: Retrieve specific content by its ID
      tags:
        - Content
      security:
        - BasicAuth: []
      responses:
        '200':
          description: Content details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ContentResponse'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
        '500':
          $ref: '#/components/responses/InternalServerError'

    put:
      summary: Update content
      description: Update existing newsletter content
      tags:
        - Content
      security:
        - BasicAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateContentRequest'
      responses:
        '200':
          description: Content updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessMessage'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
        '500':
          $ref: '#/components/responses/InternalServerError'

    delete:
      summary: Delete content
      description: Delete newsletter content by its ID
      tags:
        - Content
      security:
        - BasicAuth: []
      responses:
        '200':
          description: Content deleted successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessMessage'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/v1/contents/{id}/publish:
    parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int32
        description: Content ID

    post:
      summary: Publish content
      description: Publish newsletter content and trigger notifications
      tags:
        - Content
      security:
        - BasicAuth: []
      responses:
        '200':
          description: Content published successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessMessage'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
        '500':
          $ref: '#/components/responses/InternalServerError'

  # Email Log Endpoints
  /api/v1/email-logs:
    get:
      summary: List email logs
      description: Retrieve a list of all email delivery logs with optional pagination
      tags:
        - Email Logs
      security:
        - BasicAuth: []
      parameters:
        - name: page
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            default: 1
          description: Page number for pagination (starts from 1)
        - name: page_size
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
          description: Number of items per page (max 100)
      responses:
        '200':
          description: List of email logs
          content:
            application/json:
              schema:
                oneOf:
                  - type: array
                    items:
                      $ref: '#/components/schemas/EmailLogResponse'
                    description: Non-paginated response (when no pagination parameters provided)
                  - $ref: '#/components/schemas/PaginatedEmailLogsResponse'
                    description: Paginated response (when pagination parameters provided)
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/v1/email-logs/{id}:
    parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int32
        description: Email log ID

    get:
      summary: Get email log by ID
      description: Retrieve a specific email log by its ID
      tags:
        - Email Logs
      security:
        - BasicAuth: []
      responses:
        '200':
          description: Email log details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EmailLogResponse'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
        '500':
          $ref: '#/components/responses/InternalServerError'

  # Scheduler Endpoints
  /scheduler/v1/notifications/send:
    post:
      summary: Send notifications
      description: Send email notifications for specific content (scheduler only)
      tags:
        - Scheduler
        - Notifications
      security:
        - SchedulerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SendNotificationRequest'
      responses:
        '200':
          description: Notifications sent successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessMessage'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /scheduler/v1/notifications/pending:
    get:
      summary: Get pending notifications
      description: Retrieve list of content that needs notifications sent (scheduler only)
      tags:
        - Scheduler
        - Notifications
      security:
        - SchedulerAuth: []
      responses:
        '200':
          description: List of pending notifications
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PendingNotificationsResponse'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /scheduler/v1/notifications/retry-failed:
    post:
      summary: Retry failed notifications
      description: Retry sending failed email notifications (scheduler only)
      tags:
        - Scheduler
        - Notifications
      security:
        - SchedulerAuth: []
      responses:
        '200':
          description: Failed notifications retry initiated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessMessage'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '500':
          $ref: '#/components/responses/InternalServerError'

components:
  securitySchemes:
    BasicAuth:
      type: http
      scheme: basic
      description: Basic authentication for main API endpoints
    SchedulerAuth:
      type: http
      scheme: basic
      description: Basic authentication for scheduler endpoints (separate credentials)

  schemas:
    # Health Schemas
    HealthResponse:
      type: object
      properties:
        status:
          type: string
          example: healthy
        service:
          type: string
          example: newsletter-service

    SchedulerHealthResponse:
      type: object
      properties:
        status:
          type: string
          example: healthy
        service:
          type: string
          example: newsletter-scheduler

    # Topic Schemas
    CreateTopicRequest:
      type: object
      required:
        - name
        - description
      properties:
        name:
          type: string
          example: "Tech News"
          description: Topic name (unique)
        description:
          type: string
          example: "Latest technology updates and news"
          description: Topic description

    UpdateTopicRequest:
      type: object
      properties:
        name:
          type: string
          example: "Updated Tech News"
        description:
          type: string
          example: "Updated description"

    TopicResponse:
      type: object
      properties:
        id:
          type: integer
          format: int32
          example: 1
        name:
          type: string
          example: "Tech News"
        description:
          type: string
          example: "Latest technology updates and news"
        created_at:
          type: string
          format: date-time
          example: "2025-11-13T10:30:00Z"
        updated_at:
          type: string
          format: date-time
          example: "2025-11-13T10:30:00Z"

    # Subscriber Schemas
    CreateSubscriberRequest:
      type: object
      required:
        - email
        - name
      properties:
        email:
          type: string
          format: email
          example: "user@example.com"
          description: Subscriber email address (unique)
        name:
          type: string
          example: "John Doe"
          description: Subscriber full name

    UpdateSubscriberRequest:
      type: object
      properties:
        email:
          type: string
          format: email
          example: "newemail@example.com"
        name:
          type: string
          example: "Jane Doe"
        is_active:
          type: boolean
          example: false
          description: Whether subscriber is active

    SubscriberResponse:
      type: object
      properties:
        id:
          type: integer
          format: int32
          example: 1
        email:
          type: string
          format: email
          example: "user@example.com"
        name:
          type: string
          example: "John Doe"
        is_active:
          type: boolean
          example: true
        created_at:
          type: string
          format: date-time
          example: "2025-11-13T10:30:00Z"
        updated_at:
          type: string
          format: date-time
          example: "2025-11-13T10:30:00Z"

    # Subscription Schemas
    CreateSubscriptionRequest:
      type: object
      required:
        - subscriber_id
        - topic_id
      properties:
        subscriber_id:
          type: integer
          format: int32
          example: 1
          description: ID of the subscriber
        topic_id:
          type: integer
          format: int32
          example: 1
          description: ID of the topic to subscribe to

    SubscriptionResponse:
      type: object
      properties:
        id:
          type: integer
          format: int32
          example: 1
        subscriber_id:
          type: integer
          format: int32
          example: 1
        topic_id:
          type: integer
          format: int32
          example: 1
        created_at:
          type: string
          format: date-time
          example: "2025-11-13T10:30:00Z"

    # Content Schemas
    CreateContentRequest:
      type: object
      required:
        - topic_id
        - title
        - body
      properties:
        topic_id:
          type: integer
          format: int32
          example: 1
          description: ID of the topic this content belongs to
        title:
          type: string
          example: "New AI Breakthrough"
          description: Content title
        body:
          type: string
          example: "Scientists have discovered a new AI algorithm that..."
          description: Content body (HTML or text)

    UpdateContentRequest:
      type: object
      properties:
        topic_id:
          type: integer
          format: int32
          example: 2
        title:
          type: string
          example: "Updated AI Breakthrough"
        body:
          type: string
          example: "Updated content body..."

    ContentResponse:
      type: object
      properties:
        id:
          type: integer
          format: int32
          example: 1
        topic_id:
          type: integer
          format: int32
          example: 1
        title:
          type: string
          example: "New AI Breakthrough"
        body:
          type: string
          example: "Scientists have discovered a new AI algorithm that..."
        is_published:
          type: boolean
          example: false
          description: Whether content is published
        published_at:
          type: string
          format: date-time
          nullable: true
          example: null
          description: When content was published (null if not published)
        created_at:
          type: string
          format: date-time
          example: "2025-11-13T10:30:00Z"
        updated_at:
          type: string
          format: date-time
          example: "2025-11-13T10:30:00Z"

    # Email Log Schemas
    EmailLogResponse:
      type: object
      properties:
        id:
          type: integer
          format: int32
          example: 1
        subscriber_id:
          type: integer
          format: int32
          example: 1
        content_id:
          type: integer
          format: int32
          example: 1
        email_address:
          type: string
          format: email
          example: "user@example.com"
        subject:
          type: string
          example: "New AI Breakthrough"
        body:
          type: string
          example: "Email body content..."
        status:
          type: string
          enum: [pending, sent, failed]
          example: "sent"
          description: Email delivery status
        sent_at:
          type: string
          format: date-time
          nullable: true
          example: "2025-11-13T10:35:00Z"
        error_message:
          type: string
          nullable: true
          example: null
          description: Error message if delivery failed
        retry_count:
          type: integer
          format: int32
          example: 0
          description: Number of retry attempts
        created_at:
          type: string
          format: date-time
          example: "2025-11-13T10:30:00Z"
        updated_at:
          type: string
          format: date-time
          example: "2025-11-13T10:35:00Z"

    # Scheduler Schemas
    SendNotificationRequest:
      type: object
      required:
        - content_id
      properties:
        content_id:
          type: integer
          format: int32
          example: 1
          description: ID of content to send notifications for

    PendingNotificationsResponse:
      type: object
      properties:
        pending_notifications:
          type: integer
          format: int32
          example: 5
          description: Number of pending notifications
        content_ids:
          type: array
          items:
            type: integer
            format: int32
          example: [1, 2, 3, 4, 5]
          description: List of content IDs with pending notifications

    # Common Schemas
    SuccessMessage:
      type: object
      properties:
        message:
          type: string
          example: "Operation completed successfully"

    ErrorResponse:
      type: object
      properties:
        error:
          type: string
          example: "Error message"
        message:
          type: string
          example: "Detailed error description"

    # Pagination Schemas
    PaginationResponse:
      type: object
      properties:
        page:
          type: integer
          example: 1
          description: Current page number
        page_size:
          type: integer
          example: 20
          description: Items per page
        total_items:
          type: integer
          format: int64
          example: 150
          description: Total number of items
        total_pages:
          type: integer
          example: 8
          description: Total number of pages
        has_next:
          type: boolean
          example: true
          description: Whether there's a next page
        has_prev:
          type: boolean
          example: false
          description: Whether there's a previous page

    PaginatedTopicsResponse:
      type: object
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/TopicResponse'
          description: Array of topics
        pagination:
          $ref: '#/components/schemas/PaginationResponse'

    PaginatedSubscribersResponse:
      type: object
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/SubscriberResponse'
          description: Array of subscribers
        pagination:
          $ref: '#/components/schemas/PaginationResponse'

    PaginatedSubscriptionsResponse:
      type: object
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/SubscriptionResponse'
          description: Array of subscriptions
        pagination:
          $ref: '#/components/schemas/PaginationResponse'

    PaginatedContentResponse:
      type: object
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/ContentResponse'
          description: Array of content
        pagination:
          $ref: '#/components/schemas/PaginationResponse'

    PaginatedEmailLogsResponse:
      type: object
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/EmailLogResponse'
          description: Array of email logs
        pagination:
          $ref: '#/components/schemas/PaginationResponse'

  responses:
    BadRequestError:
      description: Bad request - invalid input
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            error: "Invalid request body"
            message: "Request validation failed"

    UnauthorizedError:
      description: Unauthorized - authentication required
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            error: "Unauthorized"
            message: "Authentication credentials required"

    NotFoundError:
      description: Resource not found
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            error: "Resource not found"
            message: "The requested resource was not found"

    TooManyRequestsError:
      description: Too many requests - rate limit exceeded
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            error: "Rate limit exceeded"
            message: "Too many requests. Please try again later."
            retry_after: 60

    InternalServerError:
      description: Internal server error
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            error: "Internal server error"
            message: "An unexpected error occurred"

tags:
  - name: Health
    description: Health check endpoints
  - name: Topics
    description: Newsletter topic management
  - name: Subscribers
    description: Subscriber management
  - name: Subscriptions
    description: Subscription management
  - name: Content
    description: Newsletter content management
  - name: Email Logs
    description: Email delivery logs and tracking
  - name: Scheduler
    description: Scheduler-only endpoints for automated tasks
  - name: Notifications
    description: Notification management